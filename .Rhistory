return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24*k) + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0.3
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24+k) + beta2 * sin((2*pi*x)/24*k)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24*k) + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0.3
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24*k) + beta2 * sin((2*pi*x)/24*k)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24*k) + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0.3
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24*k) + beta2 * sin((2*pi*x)/24*k)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24)+k + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=1
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24)+k + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=2
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24)+k + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0.3
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24*k) + beta2 * sin((2*pi*x)/24*k)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=2
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24)+k + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=4
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24)+k + beta2 * sin((2*pi*x)/24*k)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24)+k + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=4
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/24)+k + beta2 * sin((2*pi*x)/24*k)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24+k)) + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=4
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24+k)) + beta2 * sin((2*pi*x)/24*k)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line() + labs(x="Hour",y="P(Resting->Foraging"))
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line() + labs(x="Hour",y="P(Resting->Foraging")
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=0
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24+k)) + beta2 * sin((2*pi*x)/24+k)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=5
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24+k)) + beta2 * sin((2*pi*x)/24*k)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line() + labs(x="Hour",y="P(Resting->Foraging)")
qplot(rnorm(1e5,0.15,1.sqrt(500)))
qplot(rnorm(1e5,0.15,1/sqrt(500))))
qplot(rnorm(1e5,0.15,1/sqrt(500)))
qplot(rnorm(1e5,0.15,1/sqrt(700)))
qplot(rnorm(1e5,0.15,1/sqrt(1000)))
qplot(rnorm(1e5,0.15,1/sqrt(300)))
qplot(rnorm(1e5,0.01,1/sqrt(3000)))
qplot(rnorm(1e5,0.03,1/sqrt(3000)))
library(tidyr)
library(ggplot2)
library(maptools)
library(shiny)
library(raster)
library(data.table)
library(ggmap)
library(leaflet)
library(dplyr)
library(stringr)
library(chron)
library(R2jags)
library(boot)
library(knitr)
library(MCMCpack)
library(truncnorm)
newModel=T
opts_chunk$set(echo=F,warning=F,message=F,fig.width=11)
mytheme<-theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),axis.text.y=element_blank(),axis.ticks.y=element_blank(),axis.title.x=element_blank(),axis.title.y=element_blank(),panel.grid=element_blank())
if(!newModel){
load("/Users/Ben/Dropbox/Whales/Dive/WhalePhys.RData")
newModel=F
}
#get gps data
f<-list.files("/Users/Ben/Dropbox/Whales/Data/Humpback",pattern="Locations",full.names=T,recursive = T)
gdat<-lapply(f,function(x) read.csv(x,stringsAsFactors=F))
gdat<-lapply(gdat,function(x){
x$Quality<-as.character(x$Quality)
return(x)
})
gdat<-bind_rows(gdat)
#timestamp
gdat$timestamp<-as.POSIXct(gdat$Date,format="%H:%M:%S %d-%b-%Y",tz="GMT")
#
gdat<-gdat[!is.na(gdat$Latitude),]
#crop by extent
d<-SpatialPointsDataFrame(cbind(gdat$Longitude,gdat$Latitude),data=data.frame(gdat),proj4string=CRS("+proj=longlat +datum=WGS84"))
cropoly<-readShapePoly("Data/CutPolygon.shp",proj4string=CRS("+proj=longlat +datum=WGS84"))
b<-d[!is.na(d %over% cropoly)[,2],]
gdat<-b@data
#get dive data files
f<-list.files("/Users/Ben/Dropbox/Whales/Data/Humpback/",pattern="Behavior",full.names=T,recursive = T)
dat<-bind_rows(lapply(f,read.csv))
dat$timestamp<-as.POSIXct(dat$End,format="%H:%M:%S %d-%b-%Y",tz="GMT")
dat$Month<-months(dat$timestamp)
dat$Month<-factor(dat$Month,levels=month.name)
dat$Hour<-strftime(dat$timestamp,format="%H")
dat$Year<-years(dat$timestamp)
### for testing
#dat<-dat %>% filter(Ptt=="131134")
gdat<-gdat %>% filter(Ptt %in% unique(dat$Ptt))
gdat<-gdat %>% dplyr::select(Animal=Ptt,timestamp,Quality,Latitude,Longitude)
dive<-dat %>% filter(What=="Dive")%>% dplyr::select(Animal=Ptt,timestamp,Hour,Month,Year,DepthMax,DepthMin,DurationMax,DurationMin)
dive<-bind_rows(gdat,dive)
#order by timestamp
dive<-dive %>% arrange(timestamp)
ggplot(dive[,],aes(x=timestamp,y=-DepthMax)) + geom_point(size=0.1) + geom_line(size=0.1) + facet_wrap(~Animal,scales="free",ncol=3) + theme_bw()
ggsave("Figures/perindividual.jpeg",height=6,width=12)
ggplot(dive[,],aes(x=timestamp,y=-DepthMax)) + geom_point(size=0.1) + geom_line(size=0.1) + facet_wrap(~Animal,scales="free",ncol=2) + theme_bw() + geom_point(data=dive[!is.na(dive$Latitude),],y=0,col="red",size=1,aes(x=timestamp))
ggsave("Figures/perindividual.jpeg",height=6,width=12)
mdat<-dive
mybbox<-make_bbox(data=mdat,lat=Latitude,lon=Longitude,f=0.25)
troy <- get_map(location = mybbox, maptype = "toner-background")
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=-1
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24+k)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=5
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24+k)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line() + labs(x="Hour",y="P(Resting->Foraging)")
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=-1
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=5
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line() + labs(x="Hour",y="P(Resting->Foraging)")
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=-10
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=5
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line() + labs(x="Hour",y="P(Resting->Foraging)")
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=-5
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=0
k=5
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line() + labs(x="Hour",y="P(Resting->Foraging)")
x<-runif(1e4,0,24)
alpha=0.5
beta=0.5
beta2=-5
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=-10
beta=0.5
beta2=0
k=5
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line() + labs(x="Hour",y="P(Resting->Foraging)")
x<-runif(1e4,0,24)
alpha=1
beta=1
beta2=1
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d<-data.frame(x,y)
d$Season<-"Summer"
ggplot(data=d,aes(x=x,y=y,col=Season)) + geom_point() + geom_line()
x<-runif(1e4,0,24)
alpha=10
beta=0.5
beta2=0
k=5
timef<-function(x){
y<-alpha + beta* cos((2*pi*x)/(24)) + beta2 * sin((2*pi*x)/24)^2
return(data.frame(x,y))
}
y<-timef(x)
d2<-data.frame(x,y)
d2$Season<-"Fall"
d3<-bind_rows(d,d2)
ggplot(data=d3,aes(x=x,y=y,col=Season)) + geom_point() + geom_line() + labs(x="Hour",y="P(Resting->Foraging)")
head(mdart)
head(mdat)
head(mdat)
head(mdat,100)
qplot(rnorm(0.2,1/sqrt(300)))
qplot(rnorm(1e5,0.2,1/sqrt(300)))
0.5 * 0.25
a<-rnorm(1e5,5,1)
b<-rnorm(1e5,2,2)
ggplot(data.frame(a,b)) + geom_point(aes(x=,y=b))
ggplot(data.frame(a,b)) + geom_point(aes(x=a,y=b))
a<-rnorm(1e4,5,1)
b<-rnorm(1e4,2,2)
ggplot(data.frame(a,b)) + geom_point(aes(x=a,y=b))
sum(a>4 & b > 5)
sum(a>4 & b > 5)/length(a)
a<-rnorm(1e5,5,1)
b<-rnorm(1e5,2,2)
ggplot(data.frame(a,b)) + geom_point(aes(x=a,y=b))
sum(a>4 & b > 5)/length(a)
ggplot(data.frame(a,b)) + geom_point(aes(x=a,y=b,col=a>4 & b > 5))
sum(a>4)
sum(a>4)/length(a) * sum(b>5)/length(b)
(sum(a>4)/length(a) * sum(b>5)/length(b))/sum(b>5)/length(b)
(sum(a>4)/length(a) * sum(b>5)/length(b))/(sum(b>5)/length(b))
qplot(rnorm(0.15,1/sqrt(1000))
)
qplot(rnorm(0.15,1/sqrt(1000)))
qplot(rnorm(1e5,0.15,1/sqrt(1000)))
qplot(rnorm(1e5,0.15,1/sqrt(500)))
qplot(rnorm(1e5,0.15,1/sqrt(4500)))
qplot(rnorm(1e5,0.15,1/sqrt(400)))
qplot(rnorm(1e5,0.15,1/sqrt(300)))
qplot(rnorm(1e5,0.05,1/sqrt(300)))
qplot(rnorm(1e5,0.05,1/sqrt(400)))
qplot(rnorm(1e5,0.05,1/sqrt(100)))
qplot(rnorm(1e5,0.05,1/sqrt(900)))
